<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰¹å¾µå¤§è½‰ç›¤ (ç²¾æº–æ ¡æ­£ç‰ˆ)</title>
    <style>
        /* --- å…¨å±€æ¨£å¼ --- */
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background-color: #fce4ec;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #d81b60;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        /* --- è½‰ç›¤å€å¡Š --- */
        .wheel-container {
            position: relative;
            width: 350px;
            height: 350px;
            margin-bottom: 30px;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid #fff;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            position: relative;
            /* èƒŒæ™¯é¡è‰²é †åº (é †æ™‚é‡) */
            background: conic-gradient(
                #FFCDD2 0deg 45deg,   /* 1. çœ¼ç› */
                #F8BBD0 45deg 90deg,  /* 2. è€³æœµ */
                #E1BEE7 90deg 135deg, /* 3. å˜´å·´ */
                #D1C4E9 135deg 180deg,/* 4. é¼»å­ */
                #C5CAE9 180deg 225deg,/* 5. é ­é«® */
                #BBDEFB 225deg 270deg,/* 6. æ€§åˆ¥ */
                #B3E5FC 270deg 315deg,/* 7. çœ¼é¡ */
                #B2DFDB 315deg 360deg /* 8. è¡£æœ */
            );
        }

        /* --- æ–‡å­—æ¨™ç±¤ --- */
        .label {
            position: absolute;
            top: 50%; left: 50%;
            transform-origin: 0 0;
            font-size: 18px;
            font-weight: bold;
            color: #444;
            width: 175px;
            text-align: right;
            padding-right: 25px;
            box-sizing: border-box;
            line-height: 0; 
            pointer-events: none;
        }

        /* æ–‡å­—è§’åº¦è¨­å®š */
        .label:nth-child(1) { transform: rotate(22.5deg); }
        .label:nth-child(2) { transform: rotate(67.5deg); }
        .label:nth-child(3) { transform: rotate(112.5deg); }
        .label:nth-child(4) { transform: rotate(157.5deg); }
        .label:nth-child(5) { transform: rotate(202.5deg); }
        .label:nth-child(6) { transform: rotate(247.5deg); }
        .label:nth-child(7) { transform: rotate(292.5deg); }
        .label:nth-child(8) { transform: rotate(337.5deg); }

        /* --- æŒ‡é‡ (ç´…è‰²å€’ä¸‰è§’) --- */
        .pointer {
            position: absolute;
            top: -25px; left: 50%;
            transform: translateX(-50%);
            width: 0; height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #d81b60;
            z-index: 10;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }

        .center-dot {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 50px; height: 50px;
            background: #fff;
            border-radius: 50%;
            z-index: 5;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }

        /* --- æŒ‰éˆ• --- */
        button {
            padding: 15px 50px;
            font-size: 24px;
            background-color: #d81b60;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px #ad1457;
            transition: transform 0.1s;
        }
        button:active { transform: translateY(2px); box-shadow: 0 2px #ad1457; }
        button:disabled { background-color: #ccc; box-shadow: none; cursor: not-allowed; }

        /* --- å½ˆå‡ºè¦–çª— --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            max-width: 90%;
            position: relative;
            animation: popIn 0.3s ease-out;
        }

        .card-image {
            max-width: 100%;
            max-height: 70vh;
            border-radius: 10px;
            border: 2px solid #eee;
            display: block;
            margin: 0 auto 15px auto;
        }
        
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .close-btn {
            background-color: #333;
            padding: 10px 30px;
            font-size: 18px;
        }
    </style>
</head>
<body>

    <h1>âœ¨ ç‰¹å¾µå¤§è½‰ç›¤ âœ¨</h1>

    <div class="wheel-container">
        <div class="pointer"></div>
        <div class="wheel" id="wheel">
            <div class="label">çœ¼ç› ğŸ‘ï¸</div>
            <div class="label">è€³æœµ ğŸ‘‚</div>
            <div class="label">å˜´å·´ ğŸ‘„</div>
            <div class="label">é¼»å­ ğŸ‘ƒ</div>
            <div class="label">é ­é«® ğŸ’‡</div>
            <div class="label">æ€§åˆ¥ âš§ï¸</div>
            <div class="label">çœ¼é¡ ğŸ‘“</div>
            <div class="label">è¡£æœ ğŸ‘•</div>
            <div class="center-dot"></div>
        </div>
    </div>

    <button id="spinBtn" onclick="spinWheel()">æ—‹è½‰!</button>

    <div class="modal-overlay" id="modal" onclick="closeModal(event)">
        <div class="modal-content">
            <img src="" alt="å•é¡Œå¡" class="card-image" id="resultImage">
            <button class="close-btn" onclick="document.getElementById('modal').style.display='none'">é—œé–‰</button>
        </div>
    </div>

    <script>
        const wheel = document.getElementById('wheel');
        const modal = document.getElementById('modal');
        const resultImage = document.getElementById('resultImage');
        const spinBtn = document.getElementById('spinBtn');
        
        let currentDeg = 0;

        // è³‡æ–™é™£åˆ—ï¼šå°æ‡‰è½‰ç›¤ä¸Šçš„ 8 å€‹å€å¡Š
        const segments = [
            { name: "çœ¼ç›", file: "https://i.imgur.com/1vqFUSw.png" }, // Index 0
            { name: "è€³æœµ", file: "https://i.imgur.com/8FAP963.png" }, // Index 1
            { name: "å˜´å·´", file: "https://i.imgur.com/7ErUnU8.png" }, // Index 2
            { name: "é¼»å­", file: "https://i.imgur.com/h0RMS4w.png" }, // Index 3
            { 
                name: "é ­é«®", 
                file: [
                    "https://i.imgur.com/GlI3sQb.png",
                    "https://i.imgur.com/psrZEAX.png"
                ] 
            }, // Index 4
            { name: "æ€§åˆ¥", file: "https://i.imgur.com/QvQHQq6.png" }, // Index 5
            { name: "çœ¼é¡", file: "https://i.imgur.com/KoAEAeo.png" }, // Index 6
            { name: "è¡£æœ", file: "https://i.imgur.com/vRfNzeO.png" }  // Index 7
        ];

        function spinWheel() {
            spinBtn.disabled = true;
            
            // æ—‹è½‰é‚è¼¯ï¼šå¤šè½‰ 5~10 åœˆ + éš¨æ©Ÿè§’åº¦
            const randomSpins = Math.floor(Math.random() * 5) + 5; 
            const randomDegree = Math.floor(Math.random() * 360);
            const totalRotate = (randomSpins * 360) + randomDegree;
            
            currentDeg += totalRotate;
            wheel.style.transform = `rotate(${currentDeg}deg)`;

            // 4ç§’å¾Œé¡¯ç¤ºçµæœ
            setTimeout(() => {
                showResult(currentDeg);
                spinBtn.disabled = false;
            }, 4000);
        }

        // --- æ ¸å¿ƒä¿®æ­£ï¼šè¨ˆç®—çµæœ ---
        function showResult(deg) {
            const actualDeg = deg % 360;
            const segmentSize = 360 / 8; // æ¯å€‹å€å¡Š 45 åº¦

            // 1. è¨ˆç®—åŸå§‹ç´¢å¼•
            // (360 - è§’åº¦) / 45 = åŸå§‹æŒ‡å‘çš„ä½ç½®
            let rawIndex = Math.floor(((360 - actualDeg) % 360) / segmentSize);

            // 2. â˜…â˜…â˜… åç§»é‡ä¿®æ­£ (Fix Offset) â˜…â˜…â˜…
            // ä½ çš„æƒ…æ³æ˜¯ï¼šè¦–è¦ºæ˜¯è€³æœµ(1)ï¼Œç¨‹å¼ç®—å‡ºä¾†æ˜¯é¼»å­(3)ã€‚
            // æ‰€ä»¥ç¨‹å¼ç®—å‡ºä¾†çš„ç´¢å¼•æ¯”è¦–è¦ºå¤§äº† 2ã€‚
            // ä¿®æ­£å…¬å¼ï¼š(åŸå§‹ç´¢å¼• - 2 + 8) % 8
            // é€™æ¨£å°±å¯ä»¥æŠŠ "é¼»å­" çš„çµæœä¿®æ­£å› "è€³æœµ"ã€‚
            let fixedIndex = (rawIndex - 2 + 8) % 8;
            
            // ç²å–ä¿®æ­£å¾Œçš„è³‡æ–™
            const winner = segments[fixedIndex];
            let imageFile = winner.file;

            // ç‰¹æ®ŠåŠŸèƒ½ï¼šé ­é«®éš¨æ©ŸäºŒé¸ä¸€
            if (Array.isArray(winner.file)) {
                const randomIndex = Math.floor(Math.random() * winner.file.length);
                imageFile = winner.file[randomIndex];
            }

            // é¡¯ç¤ºçµæœ
            console.log("è½‰å‹•è§’åº¦:", actualDeg, "åŸå§‹ç®—å¼ç´¢å¼•:", rawIndex, "ä¿®æ­£å¾Œç´¢å¼•:", fixedIndex, "çµæœ:", winner.name);
            resultImage.src = imageFile;
            modal.style.display = 'flex';
        }

        function closeModal(e) {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>
